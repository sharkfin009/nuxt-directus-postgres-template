import{env as e}from"process";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={},n={};Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/[^A-Za-z0-9]+/g,"$").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"$"+a})).toLowerCase().replace(/(\$)(\w)/g,(function(e,r,a){return a.toUpperCase()})):""};var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"_"+a.toLowerCase()})).replace(/[^A-Za-z0-9]+|_+/g,"_").toLowerCase():""};var i={};Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"$").replace(/[^A-Za-z0-9]+/g,"$").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"$"+a})).toLowerCase().replace(/(\$)(\w?)/g,(function(e,r,a){return a.toUpperCase()})):""};var s={};Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"_"+a.toLowerCase()})).replace(/[^A-Za-z0-9]+|_+/g,".").toLowerCase():""};var u={};Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"_"+a.toLowerCase()})).replace(/[^A-Za-z0-9]+|_+/g,"/").toLowerCase():""};var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"_"+a.toLowerCase()})).replace(/[^A-Za-z0-9]+|_+/g," ").toLowerCase():""};var c={};Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(e){if(void 0===e&&(e=""),!e)return"";var r=String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"_"+a.toLowerCase()})).replace(/[^A-Za-z0-9]+|_+/g," ").toLowerCase();return r.charAt(0).toUpperCase()+r.slice(1)};var f={};Object.defineProperty(f,"__esModule",{value:!0}),f.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"_"+a.toLowerCase()})).replace(/[^A-Za-z0-9]+|_+/g," ").toLowerCase().replace(/( ?)(\w+)( ?)/g,(function(e,r,a,t){return r+a.charAt(0).toUpperCase()+a.slice(1)+t})):""};var d={};Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(e){return void 0===e&&(e=""),e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,(function(e,r,a){return r+"_"+a.toLowerCase()})).replace(/[^A-Za-z0-9]+|_+/g,"-").toLowerCase():""};var p,y={},v={};p=v,Object.defineProperty(p,"__esModule",{value:!0}),p.belongToTypes=p.isValidObject=p.isArrayObject=p.validateOptions=p.DefaultOption=void 0,p.DefaultOption={recursive:!1,recursiveInArray:!1,keepTypesOnRecursion:[]},p.validateOptions=function(e){return void 0===e&&(e=p.DefaultOption),null==e.recursive?e=p.DefaultOption:null==e.recursiveInArray&&(e.recursiveInArray=!1),e},p.isArrayObject=function(e){return null!=e&&Array.isArray(e)},p.isValidObject=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)},p.belongToTypes=function(e,r){return(r||[]).some((function(r){return e instanceof r}))};var b=r&&r.__spreadArrays||function(){for(var e=0,r=0,a=arguments.length;r<a;r++)e+=arguments[r].length;var t=Array(e),n=0;for(r=0;r<a;r++)for(var o=arguments[r],i=0,s=o.length;i<s;i++,n++)t[n]=o[i];return t};Object.defineProperty(y,"__esModule",{value:!0});var O=v;y.default=function e(r,a){if(void 0===a&&(a=O.DefaultOption),!O.isValidObject(r))return null;a=O.validateOptions(a);var t={};return Object.keys(r).forEach((function(n){var o=r[n],i=n.toLowerCase();a.recursive&&(O.isValidObject(o)?O.belongToTypes(o,a.keepTypesOnRecursion)||(o=e(o,a)):a.recursiveInArray&&O.isArrayObject(o)&&(o=b(o).map((function(r){var t=r;if(O.isValidObject(r))O.belongToTypes(t,a.keepTypesOnRecursion)||(t=e(r,a));else if(O.isArrayObject(r)){t=e({key:r},a).key}return t})))),t[i]=o})),t};var g={},A=r&&r.__spreadArrays||function(){for(var e=0,r=0,a=arguments.length;r<a;r++)e+=arguments[r].length;var t=Array(e),n=0;for(r=0;r<a;r++)for(var o=arguments[r],i=0,s=o.length;i<s;i++,n++)t[n]=o[i];return t};Object.defineProperty(g,"__esModule",{value:!0});var _=v;g.default=function e(r,a){if(void 0===a&&(a=_.DefaultOption),!_.isValidObject(r))return null;a=_.validateOptions(a);var t={};return Object.keys(r).forEach((function(n){var o=r[n],i=n.toUpperCase();a.recursive&&(_.isValidObject(o)?_.belongToTypes(o,a.keepTypesOnRecursion)||(o=e(o,a)):a.recursiveInArray&&_.isArrayObject(o)&&(o=A(o).map((function(r){var t=r;if(_.isValidObject(r))_.belongToTypes(t,a.keepTypesOnRecursion)||(t=e(r,a));else if(_.isArrayObject(r)){t=e({key:r},a).key}return t})))),t[i]=o})),t};var j={},C=r&&r.__spreadArrays||function(){for(var e=0,r=0,a=arguments.length;r<a;r++)e+=arguments[r].length;var t=Array(e),n=0;for(r=0;r<a;r++)for(var o=arguments[r],i=0,s=o.length;i<s;i++,n++)t[n]=o[i];return t};Object.defineProperty(j,"__esModule",{value:!0});var T=v,h=n;j.default=function e(r,a){if(void 0===a&&(a=T.DefaultOption),!T.isValidObject(r))return null;a=T.validateOptions(a);var t={};return Object.keys(r).forEach((function(n){var o=r[n],i=h.default(n);a.recursive&&(T.isValidObject(o)?T.belongToTypes(o,a.keepTypesOnRecursion)||(o=e(o,a)):a.recursiveInArray&&T.isArrayObject(o)&&(o=C(o).map((function(r){var t=r;if(T.isValidObject(r))T.belongToTypes(t,a.keepTypesOnRecursion)||(t=e(r,a));else if(T.isArrayObject(r)){t=e({key:r},a).key}return t})))),t[i]=o})),t};var m={},k=r&&r.__spreadArrays||function(){for(var e=0,r=0,a=arguments.length;r<a;r++)e+=arguments[r].length;var t=Array(e),n=0;for(r=0;r<a;r++)for(var o=arguments[r],i=0,s=o.length;i<s;i++,n++)t[n]=o[i];return t};Object.defineProperty(m,"__esModule",{value:!0});var z=v,w=o;m.default=function e(r,a){if(void 0===a&&(a=z.DefaultOption),!z.isValidObject(r))return null;a=z.validateOptions(a);var t={};return Object.keys(r).forEach((function(n){var o=r[n],i=w.default(n);a.recursive&&(z.isValidObject(o)?z.belongToTypes(o,a.keepTypesOnRecursion)||(o=e(o,a)):a.recursiveInArray&&z.isArrayObject(o)&&(o=k(o).map((function(r){var t=r;if(z.isValidObject(r))z.belongToTypes(t,a.keepTypesOnRecursion)||(t=e(r,a));else if(z.isArrayObject(r)){t=e({key:r},a).key}return t})))),t[i]=o})),t};var Z={},P=r&&r.__spreadArrays||function(){for(var e=0,r=0,a=arguments.length;r<a;r++)e+=arguments[r].length;var t=Array(e),n=0;for(r=0;r<a;r++)for(var o=arguments[r],i=0,s=o.length;i<s;i++,n++)t[n]=o[i];return t};Object.defineProperty(Z,"__esModule",{value:!0});var S=v,L=i;Z.default=function e(r,a){if(void 0===a&&(a=S.DefaultOption),!S.isValidObject(r))return null;a=S.validateOptions(a);var t={};return Object.keys(r).forEach((function(n){var o=r[n],i=L.default(n);a.recursive&&(S.isValidObject(o)?S.belongToTypes(o,a.keepTypesOnRecursion)||(o=e(o,a)):a.recursiveInArray&&S.isArrayObject(o)&&(o=P(o).map((function(r){var t=r;if(S.isValidObject(r))S.belongToTypes(t,a.keepTypesOnRecursion)||(t=e(r,a));else if(S.isArrayObject(r)){t=e({key:r},a).key}return t})))),t[i]=o})),t};var $={},M=r&&r.__spreadArrays||function(){for(var e=0,r=0,a=arguments.length;r<a;r++)e+=arguments[r].length;var t=Array(e),n=0;for(r=0;r<a;r++)for(var o=arguments[r],i=0,s=o.length;i<s;i++,n++)t[n]=o[i];return t};Object.defineProperty($,"__esModule",{value:!0});var K=v,V=d;$.default=function e(r,a){if(void 0===a&&(a=K.DefaultOption),!K.isValidObject(r))return null;a=K.validateOptions(a);var t={};return Object.keys(r).forEach((function(n){var o=r[n],i=V.default(n);a.recursive&&(K.isValidObject(o)?K.belongToTypes(o,a.keepTypesOnRecursion)||(o=e(o,a)):a.recursiveInArray&&K.isArrayObject(o)&&(o=M(o).map((function(r){var t=r;if(K.isValidObject(r))K.belongToTypes(t,a.keepTypesOnRecursion)||(t=e(r,a));else if(K.isArrayObject(r)){t=e({key:r},a).key}return t})))),t[i]=o})),t},Object.defineProperty(t,"__esModule",{value:!0}),t.kebabKeys=t.pascalKeys=t.snakeKeys=t.camelKeys=t.upperKeys=t.lowerKeys=t.toLowerCase=t.toUpperCase=t.toKebabCase=t.toHeaderCase=t.toSentenceCase=t.toTextCase=t.toPathCase=t.toDotCase=t.toPascalCase=t.toSnakeCase=t.toCamelCase=void 0;var D=n;t.toCamelCase=D.default;var q=o;t.toSnakeCase=q.default;var R=i;t.toPascalCase=R.default;var U=s;t.toDotCase=U.default;var I=u;t.toPathCase=I.default;var E=l;t.toTextCase=E.default;var F=c;t.toSentenceCase=F.default;var x=f;t.toHeaderCase=x.default;var H=d;t.toKebabCase=H.default;var J=y;t.lowerKeys=J.default;var N=g;t.upperKeys=N.default;var G=j;t.camelKeys=G.default;var B=m;t.snakeKeys=B.default;var Q=Z;t.pascalKeys=Q.default;var W=$;t.kebabKeys=W.default;var X=function(e){return String(e||"").toLowerCase()};t.toLowerCase=X;var Y=function(e){return String(e||"").toUpperCase()};t.toUpperCase=Y;var ee={toCamelCase:D.default,toSnakeCase:q.default,toPascalCase:R.default,toDotCase:U.default,toPathCase:I.default,toTextCase:E.default,toSentenceCase:F.default,toHeaderCase:x.default,toKebabCase:H.default,toUpperCase:Y,toLowerCase:X,lowerKeys:J.default,upperKeys:N.default,camelKeys:G.default,snakeKeys:B.default,pascalKeys:Q.default,kebabKeys:W.default};t.default=ee;var re=a(t),ae=(r,{services:a,exceptions:t,database:n,schema:o})=>{r.post("/send",(async(r,t)=>{console.log("enquiry received",r.body);const{MailService:n,ItemsService:i,UsersService:s}=a;let u=[];if(r.body.customerFormData)for(const[e,a]of Object.entries(r.body.customerFormData))u.push(`${re.toSentenceCase(e)}:${a}`);let l=[];if(r.body.enquiryFormData)for(let[e,a]of Object.entries(r.body.enquiryFormData)){if("minors"===e){e="minors(2 to 11 years)";let r=JSON.parse(a),t=r.length;a=t>0?`${t} Minor${1==t?"":"s"} ( Birthdate${t=""} ${r.join(", ")} )`:""}"no_of_infants"===e&&(console.log("infants",a),e="Infants(up to 2 years)",a='""'!==a?a:""),l.push(`${re.toSentenceCase(e)}:${a}`)}let c={general_enquiries:"General",package_enquiries:"Package",group_enquiries:"Group",flight_special_enquiries:"Flight Special",contact_enquiries:"Contact Us"};console.log(e.EMAIL_TEMPLATES_PATH);let f={enquiryType:c[r.body.enquiryType],customer:u,enquiry:l,consultant:r.body.consultant,imageURL:r.body.imageURL},d="A new "+c[r.body.enquiryType]+" Enquiry has come in";console.log("data",JSON.stringify(f,null,4));const p=new n({schema:o});await p.send({to:["lala@hippl.co","sharkfin007@yahoo.com","ben.amato@gmail.com","lindsay@computravel.co.za"],subject:d,template:{name:"enquiry",data:{data:f}}}),f.title=r.body?.title,console.log("customer email",JSON.stringify(r.body));await p.send({to:[r.body?.customerFormData?.email],subject:"Thank you for your enquiry",template:{name:"enquiry_confirmation",data:{data:f}}}),t.send(f)}))};export{ae as default};
