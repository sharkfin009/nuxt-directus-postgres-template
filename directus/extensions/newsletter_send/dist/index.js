var e=async(e,{services:o,exceptions:a,database:t,schema:l})=>{e.post("/send",(async(e,a)=>{console.log("send newsletter ext",e.body);const{MailService:t}=o,s=new t({schema:l});let c=[];for(let o of e.body.subscribers)c.push(o.email);let n=[];e.body.testMode?n.push("lindsay@computravel.co.za","lala@hippl.co","ben.amato@gmail.com"):n.push(...c),console.log("mailList",c),console.log("recipients",n);try{await s.send({to:["ben.amato@gmail.com","lindsay@computravel.co.za","lala@hippl.co"],subject:e.body.title,template:{name:"newsletter",data:{html:e.body.html}}})}catch(e){console.log("endpoint error",e)}a.send()}))};export{e as default};
